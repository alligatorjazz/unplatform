---
import { type Page } from "astro";
import { getCollection, type CollectionEntry } from "astro:content";
import dayjs from "dayjs";
import IssueCard from "./IssueCard.astro";

type Props = {
	direction?: "row" | "column";
	hideDescriptions?: boolean;
} & (
	| { page: Page<CollectionEntry<"issues">>; limit?: undefined }
	| { page?: undefined; limit: number }
);
const { page, limit, direction, hideDescriptions } = Astro.props;
const issueCollection = (await getCollection("issues")).sort((a, b) =>
	dayjs(b.data.publishDate).diff(a.data.publishDate)
);
const filteredCollection = (page?.data ? page.data : issueCollection).slice(
	0,
	limit
);
type IssueEntry = CollectionEntry<"issues">;
---

<section
	class:list={[
		"flex items-center justify-center",
		direction == "row" ? "flex-row" : "flex-col",
	]}
>
	{
		filteredCollection.map((issue: IssueEntry) => (
			<IssueCard
				issue={issue}
				hideDescription={hideDescriptions}
				class={direction == "row" ? "" : "w-full"}
			/>
		))
	}
</section>
